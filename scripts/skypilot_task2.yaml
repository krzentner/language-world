resources:
  cloud: gcp
  instance_type: c2-standard-16
  #image_id: projects/ubuntu-os-cloud/global/images/ubuntu-2204-jammy-v20230429
  image_id: skypilot:cpu-debian-10

num_nodes: 1  # Number of VMs to launch

# Working directory (optional) containing the project codebase.
# Its contents are synced to ~/sky_workdir/ on the cluster.
workdir: ~/language-to-policies/

# Commands to be run before executing the job.
# Typical use: pip install -r requirements.txt, git clone, etc.
setup: |
  curl -sSL https://install.python-poetry.org | python3 -

  mkdir -p $HOME/.mujoco && \
  curl -O https://mujoco.org/download/mujoco210-linux-x86_64.tar.gz && \
  tar xf mujoco210-linux-x86_64.tar.gz --directory $HOME/.mujoco

  echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$HOME/.mujoco/mujoco210/bin' >> ~/.bashrc
  echo 'export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$HOME/.mujoco/mujoco210/bin' >> ~/.profile
  source ~/.profile
  source ~/.bashrc

  conda create -y -n l2p-py38 python=3.8
  source activate l2p-py38
  pip install --upgrade --user pip
  poetry install

# Commands to run as a job.
# Typical use: launch the main program.
run: |
  source "$HOME/.profile"
  source activate l2p-py38
  poetry install
  poetry run python src/test_experiment.py --content "Hello Sky" --out-file "data/hello_sky.txt"
