resources:
  cloud: gcp
  instance_type: c2-standard-30
  #image_id: projects/ubuntu-os-cloud/global/images/ubuntu-2204-jammy-v20230429
  image_id: skypilot:cpu-debian-10

num_nodes: 1  # Number of VMs to launch

# Working directory (optional) containing the project codebase.
# Its contents are synced to ~/sky_workdir/ on the cluster.
workdir: ~/language-to-policies/

# Commands to be run before executing the job.
# Typical use: pip install -r requirements.txt, git clone, etc.
setup: |
  conda create -y -n l2p-py38 python=3.8
  source activate l2p-py38
  ./scripts/setup_vm.sh

# Commands to run as a job.
# Typical use: launch the main program.
run: |
  source "$HOME/.profile"
  source activate l2p-py38
  poetry install
  mkdir data_tmp
  poetry run pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
  poetry run {command}
